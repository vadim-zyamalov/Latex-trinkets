# Класс документа для отчетов, оформленных по НИР

Данный файл представляет собой сильно видоизмененный класс `extreport`, предоставляющий оформление документов по ГОСТ 7.32-2017.

На Гитхабе есть несколько похожих проектов, однако они имеют один существенный недостаток: они неявно подгружают большое число сторонних пакетов, что потенциально может привести к ситуации конфликта параметров. Настоящий класс создавался с учетом этого, он подгружает минимум пакетов сверх тех, что используются исходным классом `extreport`:

- `etoolbox`: содержит ряд полезных хуков, позволяющих исполнять код в конце преамбулы или начале документа.
- `kvoptions`: позволяет задавать параметры вида `key=value`.
- `makecell`: создание ячеек со сложным форматированием.

## Опции класса

Класс принимает следующие опции:

| Опция                     | Эффект                                             |
|---------------------------|----------------------------------------------------|
| a4paper                   | Формат страницы: A4                                |
| {8,9,10,11,12,14,17,20}pt | Основной размер шрифта                             |
| oneside                   | Документ на одной стороне листа                    |
| twoside                   | Документ на обоих сторонах листа                   |
| numinchap                 | Нумерация формул, таблиц и рисунков по главам      |
| draft                     | Черновик (большие поля)                            |
| final                     | Итоговый документ                                  |
| numindoc                  | Сквозная нумерация формул, таблиц и рисунков       |
| openright                 | Опция `extreport`, по-видимому --- переплет справа |
| leqno                     | Нумерация формул слева                             |
| fleqn                     | Нумерация формул справа                            |

## Титульный лист

Для создания элементов титульного листа применяются следующие команды:

| Команда                                | Эффект                                                    | Примечание                                         |
|----------------------------------------|-----------------------------------------------------------|----------------------------------------------------|
| NirUdk                                 | Номер УДК                                                 |                                                    |
| NirRegNo                               | Регистрационный номер НИР                                 |                                                    |
| NirInnerNo                             | Инвентарный номер НИР                                     |                                                    |
| NirClassified                          | Гриф                                                      | Не используется                                    |
| NirApprove                             | Надпись "Утверждаю"                                       |                                                    |
| NirOrgLongName                         | Полное название организации                               |                                                    |
| NirType                                | Тип НИР                                                   | "Отчёт" и т.д.                                     |
| NirAbout                               | О чем НИР                                                 | "о научно-исследовательской работе" и т.д          |
| NirAnnotate                            | Аннотационный???                                          | Не используется                                    |
| NirPartNo                              | Часть НИР                                                 | Не используется                                    |
| NirYear                                | Год исполнения                                            |                                                    |
| NirTown                                | Город                                                     |                                                    |
| Nir{Approver,Supervisor,Executor}Stamp | Данные утверждающего лица / руководителя / исполнителя    | Маловероятно, что потребуется правка               |
| Nir{Approver,Supervisor,Executor}Post  | Должность утверждающего лица / руководителя / исполнителя |                                                    |
| Nir{Approver,Supervisor,Executor}Name  | Имя утверждающего лица / руководителя / исполнителя       |                                                    |
| Nir{Approver,Supervisor,Executor}      | Объединение двух предыдущих команд                        |                                                    |
| NirTitle                               | Название НИР                                              |                                                    |
| NirSubject                             | Тема НИР                                                  |                                                    |
| NirSubjectModifier                     | "Модификатор"                                             | "по теме"                                          |
| intermediatename                       | Название для промежуточного отчета                        | "промежуточный"                                    |
| finalname                              | Название для итогового отчета                             | "заключительный"                                   |
| NirFinal                               | Указание на то, что отчет итоговый                        | Необязательный аргумент может заменить `finalname` |

## Дополнительные окружения

- `abstract`: переопределенное окружение из `extreport`.

  Создает реферат отчета. После заголовка автоматически вставляется строка с числом страниц, рисунков, таблиц, источников и приложений.

- `executors`: создание списка исполнителей.

  Данное окружение должно включать в себя **ТОЛЬКО** команды `executor` с тремя аргументами:

  1. Должность.

  2. Имя.

  3. Вклад в НИР.

- `nirdefslist` и `nirabbrlist`: списки определений и сокращений.

  Являются обёртками над окружением `description`, поэтому должны включать в себя `\item[]`.

% Beamer theme for RANEPA presentations

\mode<presentation>


%%% Цветовая тема %%%

\usecolortheme{default}

\definecolor{LightCyan}{rgb}{0.88,1,1}
\definecolor{LightRed}{rgb}{1,0.5,0.5}
\definecolor{RanepaRed}{rgb}{0.574,0.098,0.137}

\definecolor{beamer@ranepared}{rgb}{0.574,0.098,0.137}
\setbeamercolor{structure}{fg=beamer@ranepared}
\setbeamercolor{bibliography item}{fg=beamer@ranepared}
\setbeamercolor*{bibliography entry title}{fg=black}
\setbeamercolor*{bibliography entry author}{fg=black}
\setbeamercolor*{bibliography entry note}{fg=black}


%%% Внутренняя тема %%%

\useinnertheme{circles}

% Нет разных цветов в списке
\setbeamertemplate{bibliography entry article}{}
\setbeamertemplate{bibliography entry title}{}
\setbeamertemplate{bibliography entry location}{}
\setbeamertemplate{bibliography entry note}{}

% Настраиваем меркеры
% Треугольники
% \setbeamertemplate{bibliography item}[triangle]

% или красивые иконки
\setbeamertemplate{bibliography item}
{\ifboolexpr{ test {\ifentrytype{book}}
    or test {\ifentrytype{mvbook}}
    or test {\ifentrytype{collection}}
    or test {\ifentrytype{mvcollection}}
    or test {\ifentrytype{reference}}
    or test {\ifentrytype{mvreference}} }
  {\setbeamertemplate{bibliography item}[book]}
  {\ifentrytype{online}
    {\setbeamertemplate{bibliography item}[online]}
    {\setbeamertemplate{bibliography item}[article]}}%
  \usebeamertemplate{bibliography item}}


%%% Внешняя тема %%%

\useoutertheme{default}

% Титульный лист
\makeatletter
\setbeamertemplate{title page}
{\vbox{}
  \vfill
  \begingroup
  \centering
  \begin{beamercolorbox}[sep=8pt,center]{title}
    \usebeamerfont{title}\inserttitle\par%
    \ifx\insertsubtitle\@empty%
    \else%
    \vskip0.25em%
    {\usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\insertsubtitle\par}%
    \fi%
  \end{beamercolorbox}%
  \vskip1em\par
  \begin{beamercolorbox}[sep=8pt,center]{author}
    \usebeamerfont{author}\insertauthor
  \end{beamercolorbox}
  \begin{beamercolorbox}[sep=8pt,center]{institute}
    \usebeamerfont{institute}\insertinstitute
  \end{beamercolorbox}
  {\usebeamercolor[fg]{titlegraphic}\inserttitlegraphic\par}
  \endgroup
  \vfill}

\def\ps@navigation@titlepage{%
  \setbeamertemplate{headline}%
  {\vskip 5pt \hskip 5pt \includegraphics[height=1cm]{logos/logo_ranepa.pdf} \hskip 5pt \includegraphics[height=1cm]{logos/logo_iep.pdf}}%
  \setbeamertemplate{footline}%
  {\makebox[\paperwidth][c]%
    {\scriptsize\insertdate}\vskip 5pt}%
  \@nameuse{ps@navigation}}
  \addtobeamertemplate{title page}{\thispagestyle{navigation@titlepage}}{}
\makeatother

% Заголовки с выравниванием номеров разделов и подразделов
\makeatletter
\setbeamertemplate{frametitle}%
{\ifbeamercolorempty[bg]{frametitle}{}{\nointerlineskip}%
  \@tempdima=\textwidth%
  \advance\@tempdima by\beamer@leftmargin%
  \advance\@tempdima by\beamer@rightmargin%
  \begin{beamercolorbox}[sep=0.3cm,left,wd=\the\@tempdima]{frametitle}
    \usebeamerfont{frametitle}%
    \vbox{}\vskip-1ex%
    \if@tempswa\else\csname beamer@fteleft\endcsname\fi%
    \strut%
    \ifx\insertframetitle\@empty%
    \else%
    {\ifnumequal{\thesection}{0}%
      {}%
      {\insertsectionnumber%
        \ifnumequal{\thesubsection}{0}%
        {~}%
        {.\insertsubsectionnumber~}}%
      \insertframetitle}\fi%
    \par%
    {\ifx\insertframesubtitle\@empty%
      \else%
      {\ifnumequal{\thesection}{0}%
        {}%
        {\hphantom{\insertsectionnumber}%
          \ifnumequal{\insertsubsectionnumber}{0}%
          {\hphantom{~}}%
          {\hphantom{.\insertsubsectionnumber~}}}%
        \usebeamerfont{framesubtitle}\usebeamercolor[fg]{framesubtitle}\strut\insertframesubtitle\par}\fi}%
    \vskip-1ex%
    \if@tempswa\else\vskip-.3cm\fi% set inside beamercolorbox... evil here...
  \end{beamercolorbox}%
}
\makeatother

% Номер слайдов в подвале слайда
\setbeamertemplate{footline}
{\makebox[\paperwidth][r]
  {\tiny\insertframenumber\hskip 5pt}\vskip 5pt}

% Номер слайда-продолжения
\makeatletter
\setbeamertemplate{frametitle continuation}{%
  (\insertcontinuationcount)%
}
\makeatother

% Нумерация приложений буквами
\makeatletter
\renewcommand<>\appendix{%
  \setcounter{section}{0}%
  \renewcommand\insertsectionnumber{\Alph{section}}%
  \only#1{\part{\appendixname}
    \addtocontents{nav}{\protect\headcommand{\protect\beamer@appendixpages{\the\c@page}}}}}
\makeatother


%%% Шрифтовая тема %%%

\usefonttheme{default}

% Serif в формулах
\usefonttheme[onlymath]{serif}


%%% Дополнительные настройки %%%
\setbeamertemplate{navigation symbols}{}


%%% Вспомогательные команды и окружения %%%

% Маnематические функции
\newcommand{\E}{\operatorname{E}}
\newcommand{\Var}{\operatorname{var}}
\newcommand{\Cov}{\operatorname{cov}}
\newcommand{\Corr}{\operatorname{corr}}

% Доказательства на несколько слайдов
\makeatletter
\newenvironment<>{proofs}[1][\proofname]{%
    \par
    \def\insertproofname{#1\@addpunct{.}}%
    \usebeamertemplate{proof begin}#2}
  {\usebeamertemplate{proof end}}
\makeatother

% Номер слайда для оверлеев
\makeatletter
\newcommand*{\slideinframe}{\number\beamer@slideinframe}
\makeatother

\mode
<all>
